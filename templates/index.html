<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Celestium - Infinite Horizons</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <style>
        body { margin: 0; background: #000; color: white; font-family: 'Segoe UI', sans-serif; }
        .hero {
            height: 100vh; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)),
                url('{{ url_for("static", filename="textures/stars.jpg") }}');
            background-size: cover; text-align: center;
        }
        h1 { font-size: 4rem; margin-bottom: 10px;
            background: linear-gradient(to right, #4facfe, #00f2fe);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .btn { padding: 15px 30px; font-size: 1.2rem; background: #4facfe;
            color: white; text-decoration: none; border-radius: 30px; margin-top: 20px;
            transition: 0.3s; }
        .btn:hover { background: #00f2fe; transform: scale(1.05); }

        .modal {
            display:none; position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.6); justify-content:center; align-items:center;
        }
        .modal-content {
            background:#0b1220; padding:30px; border-radius:12px;
            width:350px; text-align:center; box-shadow:0 0 20px #4facfe;
        }
        input {
            width:90%; padding:10px; margin:10px 0;
            border-radius:8px; border:1px solid #4facfe; background:#111827; color:white;
        }
        button {
            width:94%; padding:10px; margin-top:10px;
            background:#4facfe; border:none; border-radius:8px;
            font-size:16px; cursor:pointer;
        }
        button:hover { background:#00f2fe; }

        .password-wrapper { position:relative; }
        .toggle-eye {
            position:absolute; right:15px; top:50%; transform:translateY(-50%);
            cursor:pointer; font-size:18px;
        }
        .switch-link { cursor:pointer; margin-top:10px; color:#4facfe; }
    </style>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
</head>
<canvas id="chaos-stars"></canvas>

<body>

<nav class="navbar">
    <div class="logo">Celestium</div>
    <div class="nav-links">
        <a href="/index">Home</a>
        <a href="/universe">Universe Explorer</a>
        <a href="/lessons">LearnCore</a>
        <a href="/quizzes">Quiz Zone</a>
        <a href="/missions">Mission Builder</a>
        <a href="/dashboard">Dashboard</a>
        <a href="#" id="chaos-mode-toggle" class="nav-btn chaos-btn">CHAOS MODE</a>


        <input
    type="range"
    id="chaosIntensity"
    min="1"
    max="5"
    value="3"
    title="Chaos Intensity"
    style="margin-left:15px; width:120px; display:none;"
>
<a href="#" id="loginBtn" class="nav-btn login-btn">Login</a>
<script>
/* ============ CHAOS MODE + INTENSITY SLIDER ============ */

document.addEventListener("DOMContentLoaded", () => {

    const chaosBtn = document.getElementById("chaos-mode-toggle");
    const slider = document.getElementById("chaosIntensity");
    const canvas = document.getElementById("chaos-stars");
    const ctx = canvas.getContext("2d");

    let stars = [];
    let running = false;
    let intensity = parseInt(localStorage.getItem("chaosIntensity")) || 3;

    slider.value = intensity;

    function resize() {
        canvas.width = innerWidth;
        canvas.height = innerHeight;
    }
    resize();
    addEventListener("resize", resize);

    class Star {
        constructor() { this.reset(); }
        reset() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * -canvas.height;
            this.size = Math.random() * (intensity + 2);
            this.speed = Math.random() * (intensity * 0.8) + 0.5;
        }
        update() {
            this.y += this.speed;
            if (this.y > canvas.height) this.reset();
        }
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fillStyle = "rgba(0,255,255,0.8)";
            ctx.shadowBlur = 15;
            ctx.shadowColor = "#00ffff";
            ctx.fill();
        }
    }

    function buildStars() {
        stars = [];
        const count = intensity * 40;
        for (let i = 0; i < count; i++) stars.push(new Star());
    }

    function animate() {
        if (!running) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        stars.forEach(s => { s.update(); s.draw(); });
        requestAnimationFrame(animate);
    }

    function enableChaos() {
        document.body.classList.add("chaos-mode-active");
        chaosBtn.innerText = "EXIT CHAOS MODE";
        slider.style.display = "inline-block";
        localStorage.setItem("chaosMode", "true");

        running = true;
        buildStars();
        animate();
    }

    function disableChaos() {
        document.body.classList.remove("chaos-mode-active");
        chaosBtn.innerText = "CHAOS MODE";
        slider.style.display = "none";
        localStorage.setItem("chaosMode", "false");

        running = false;
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    chaosBtn.onclick = (e) => {
        e.preventDefault();
        document.body.classList.contains("chaos-mode-active")
            ? disableChaos()
            : enableChaos();
    };

    slider.oninput = () => {
        intensity = parseInt(slider.value);
        localStorage.setItem("chaosIntensity", intensity);
        if (running) buildStars();
    };

    // Restore state
    if (localStorage.getItem("chaosMode") === "true") {
        enableChaos();
    }
});
</script>

    </div>
</nav>

<div class="hero">
    <h1>CELESTIUM</h1>
    <p style="font-size:1.5rem;">Experience the Cosmos. Powered by NASA Data.</p>
    <a href="/universe" class="btn">Launch Universe Explorer</a>
</div>

<!-- CHAOS FALLING STARS -->
<canvas id="chaos-stars"></canvas>

<div id="loginModal" class="modal">
    <div class="modal-content">
        <input id="loginEmail" type="email" placeholder="Email">
        <div class="password-wrapper">
            <input id="loginPassword" type="password" placeholder="Password">
            <span class="toggle-eye" onclick="togglePassword('loginPassword', this)">üëÅ</span>
        </div>
        <button onclick="login()">Login</button>
        <p class="switch-link" onclick="openSignup()">Create an account</p>
        <p class="switch-link" onclick="resetPassword()">Forgot Password?</p>
    </div>
</div>

<div id="signupModal" class="modal">
    <div class="modal-content">
        <h2>Create Account</h2>
        <input id="signupEmail" type="email" placeholder="Email">
        <div class="password-wrapper">
            <input id="signupPassword" type="password" placeholder="Password">
            <span class="toggle-eye" onclick="togglePassword('signupPassword', this)">üëÅ</span>
        </div>
        <button onclick="signup()">Sign Up</button>
        <p class="switch-link" onclick="openLogin()">Already have an account?</p>
    </div>
</div>

<div id="toast" style="position:fixed;top:20px;right:20px;padding:12px 20px;background:#4facfe;color:black;border-radius:6px;display:none;font-weight:bold;z-index:30000;"></div>

<script>
firebase.initializeApp({
    apiKey: "AIzaSyD2E-b2n4OuJINYhklp4dPA9NTEBfcGukU",
    authDomain: "celestium-bdc0f.firebaseapp.com",
    projectId: "celestium-bdc0f",
    appId: "1:658396275584:web:f261e5730d43f5d8e6d765"
});
const auth = firebase.auth();

loginBtn.onclick = () => loginModal.style.display = "flex";

function openSignup(){ loginModal.style.display="none"; signupModal.style.display="flex"; }
function openLogin(){ signupModal.style.display="none"; loginModal.style.display="flex"; }

function signup(){
    auth.createUserWithEmailAndPassword(
        signupEmail.value, signupPassword.value
    ).then(u=>{
        u.user.sendEmailVerification();
        showMessage("Verification email sent!");
        openLogin();
    }).catch(e=>showMessage(e.message));
}

function login(){
    auth.signInWithEmailAndPassword(
        loginEmail.value, loginPassword.value
    ).then(u=>{
        if(!u.user.emailVerified){
            showMessage("Verify email first!");
            auth.signOut();
            return;
        }
        window.location="/dashboard";
    }).catch(e=>showMessage(e.message));
}

function resetPassword(){
    auth.sendPasswordResetEmail(loginEmail.value)
        .then(()=>showMessage("Reset email sent"))
        .catch(e=>showMessage(e.message));
}

function showMessage(m){
    toast.innerText=m; toast.style.display="block";
    setTimeout(()=>toast.style.display="none",3000);
}

function togglePassword(id,eye){
    const i=document.getElementById(id);
    i.type=i.type==="password"?"text":"password";
}
</script>
<script>
/* ========= CHAOS MODE + STARS + INTENSITY (FINAL FIX) ========= */

document.addEventListener("DOMContentLoaded", () => {

    const chaosBtn = document.getElementById("chaos-mode-toggle");
    const slider = document.getElementById("chaosIntensity");
    const canvas = document.getElementById("chaos-stars");
    const ctx = canvas.getContext("2d");

    let stars = [];
    let intensity = parseInt(localStorage.getItem("chaosIntensity")) || 3;
    let chaosOn = false;

    slider.value = intensity;

    function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);

    class Star {
        constructor() {
            this.reset();
        }
        reset() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * -canvas.height;
            this.size = Math.random() * (intensity * 1.5) + 1.5;
            this.speed = Math.random() * (intensity * 0.8) + 0.6;
        }
        update() {
            this.y += this.speed;
            if (this.y > canvas.height) this.reset();
        }
        draw() {
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fillStyle = "rgba(0,255,255,0.85)";
            ctx.shadowBlur = 8;           // üîë reduced (GPU safe)
            ctx.shadowColor = "#00ffff";
            ctx.fill();
        }
    }

    function buildStars() {
        stars = [];
        const count = intensity * 50;
        for (let i = 0; i < count; i++) stars.push(new Star());
    }

    function animate() {
        if (!chaosOn) return;

        ctx.clearRect(0, 0, canvas.width, canvas.height);

        stars.forEach(star => {
            star.update();
            star.draw();
        });

        requestAnimationFrame(animate);
    }

    function enableChaos() {
        chaosOn = true;
        document.body.classList.add("chaos-mode-active");
        chaosBtn.innerText = "EXIT CHAOS MODE";
        slider.style.display = "inline-block";

        localStorage.setItem("chaosMode", "true");

        buildStars();
        animate();
    }

    function disableChaos() {
        chaosOn = false;
        document.body.classList.remove("chaos-mode-active");
        chaosBtn.innerText = "CHAOS MODE";
        slider.style.display = "none";

        localStorage.setItem("chaosMode", "false");

        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    chaosBtn.addEventListener("click", (e) => {
        e.preventDefault();
        chaosOn ? disableChaos() : enableChaos();
    });

    slider.addEventListener("input", () => {
        intensity = parseInt(slider.value);
        localStorage.setItem("chaosIntensity", intensity);
        if (chaosOn) buildStars(); // üî• instant effect
    });

    /* Restore state */
    if (localStorage.getItem("chaosMode") === "true") {
        enableChaos();
    }
});
</script>



</body>
</html>

